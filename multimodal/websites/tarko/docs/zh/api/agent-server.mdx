---
title: Agent Server API
description: Tarko Agent Server 的完整 API 参考
---

# Agent Server API

Tarko Agent Server 的完整 API 参考。

## Runtime Settings

Runtime Settings 允许用户在 Agent 执行过程中动态配置行为，无需重启服务器。这些设置为通过 UI 调整 Agent 参数提供了灵活的方式。

### AgentRuntimeSettings

定义 Runtime Settings 配置的主要接口。

```typescript
interface AgentRuntimeSettings {
  schema: AgentRuntimeSettingsSchema;
  transform?: (runtimeSettings: any) => any;
  placement?: 'dropdown-item' | 'chat-bottom';
}
```

#### 属性

- **`schema`** - 定义结构和 UI 渲染的 JSON Schema
- **`transform`** - 可选函数，将设置转换为 Agent 特定选项
- **`placement`** - UI 放置配置（默认：`'dropdown-item'`）

### Schema 定义

```typescript
interface AgentRuntimeSettingsSchema {
  type: 'object';
  properties: Record<string, AgentRuntimeSettingProperty>;
}
```

### 设置属性

每个设置属性支持丰富的 UI 配置：

```typescript
interface AgentRuntimeSettingProperty {
  type: 'boolean' | 'string' | 'number';
  title?: string;
  default?: any;
  enum?: string[];
  enumLabels?: string[];
  description?: string;
  icon?: string;
  placement?: 'dropdown-item' | 'chat-bottom';
  visible?: AgentRuntimeSettingVisibilityCondition;
}
```

#### 主要特性

- **枚举支持** - 使用 `enum` 定义下拉选项，`enumLabels` 设置显示名称
- **条件可见性** - 基于其他设置值显示/隐藏设置
- **UI 放置** - 控制设置在界面中的显示位置
- **图标** - 添加视觉指示器以改善用户体验

### 可见性条件

基于其他设置值使设置条件可见：

```typescript
interface AgentRuntimeSettingVisibilityCondition {
  dependsOn: string;
  when: any;
}
```

### 配置示例

```typescript
const runtimeSettings: AgentRuntimeSettings = {
  schema: {
    type: 'object',
    properties: {
      model: {
        type: 'string',
        title: 'Model',
        enum: ['gpt-4', 'gpt-3.5-turbo', 'claude-3'],
        enumLabels: ['GPT-4', 'GPT-3.5 Turbo', 'Claude 3'],
        default: 'gpt-4',
        icon: 'model',
        description: '为此 Agent 选择 AI Model'
      },
      temperature: {
        type: 'number',
        title: 'Temperature',
        default: 0.7,
        description: '控制响应的随机性'
      },
      enableTools: {
        type: 'boolean',
        title: '启用 Tool',
        default: true,
        description: '允许 Agent 使用外部 Tool'
      },
      toolMode: {
        type: 'string',
        title: 'Tool 模式',
        enum: ['auto', 'manual'],
        enumLabels: ['自动', '手动'],
        default: 'auto',
        visible: {
          dependsOn: 'enableTools',
          when: true
        }
      }
    }
  },
  transform: (settings) => ({
    model: { id: settings.model },
    temperature: settings.temperature,
    tools: settings.enableTools ? { mode: settings.toolMode } : undefined
  }),
  placement: 'dropdown-item'
};
```

### UI 放置选项

- **`dropdown-item`** - 设置出现在下拉菜单中（默认）
- **`chat-bottom`** - 设置出现在聊天界面底部

### Transform 函数

可选的 `transform` 函数将 UI 设置值转换为 Agent 特定选项：

```typescript
transform: (runtimeSettings) => {
  return {
    model: { id: runtimeSettings.model },
    temperature: runtimeSettings.temperature,
    // 将 UI 值转换为 Agent 选项格式
  };
}
```

## 即将推出

其他 API 文档正在开发中：

- Server 构造函数选项
- HTTP 端点
- WebSocket 事件
- 响应模式

目前请参考 [Server Guide](/guide/deployment/server) 了解使用示例。
